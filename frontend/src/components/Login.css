
.login-container {
  display: flex;
  justify-content: center;
  align-items: center;
  /* Fallback first, then dynamic viewport to account for iOS URL bar */
  min-height: 100vh;
  min-height: 100dvh;
  background-color: #ffffff;
  font-family: 'Arial', sans-serif;
  /* Allow vertical scroll on small screens */
  overflow-x: hidden;
  overflow-y: auto;
  position: relative;
}

/* Envelope wrapper â€” centered box */
.wrapper {
  width: min(92vw, 500px); /* scale down on narrow screens */
  height: auto; /* let the base image set the height */
  position: absolute;
  bottom: 1%; /* default desktop/tablet: near bottom for nice staging */
  display: block;
  z-index: 0;
  /* Move the interior texture up/down without changing geometry */
  --envbg-offset: 8px;
  /* Simple first paint guard: fade in envelope to avoid initial flicker */
  opacity: 0;
  pointer-events: none;
  animation: envelopeFadeIn 220ms ease 120ms forwards;
}

@keyframes envelopeFadeIn {
  to {
    opacity: 1;
    pointer-events: auto;
  }
}

/* Envelope lids (full-width triangle aligned to envelope opening) */
.lid {
  position: absolute;
  top: var(--lid-top, 21.5%); /* adjust to match envelope opening */
  width: 100%;
  height: var(--lid-height, 39.5%);
  transform-origin: top center;
  transition: transform 0.25s linear;
  -webkit-clip-path: polygon(0%, 0%, 100% 0%, 50% 100%);
  clip-path: polygon(5.9% 11.5%, 94.1% 11.5%, 50% 100%);
}

/* Lid when closed (front/top) */
.lid.one {
  background-color: #efe6d3; /* front: light cream */
  background-image: url('../assets/paper_texture.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-blend-mode: multiply;
  filter: saturate(0.9) brightness(1.02) contrast(0.96);
  transform: rotateX(0deg);
  z-index: 4; /* above base and letter */
  transition-delay: 0.75s;
}

/* Lid when opened (back) */
.lid.two {
  background-color: #e2d8c3; /* back: slightly darker cream */
  background-image: url('../assets/paper_texture.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-blend-mode: multiply;
  filter: saturate(0.9) brightness(1.0) contrast(0.98);
  transform: rotateX(90deg);
  z-index: 1;
  transition-delay: 0.5s;
  /* When opened, nudge position if it appears too high */
  top: calc(var(--lid-top, 28.5%) + var(--lid-open-offset, 2%));
  height: calc(var(--lid-height, 39.5%) - var(--lid-open-offset, 2%));
}

/* Envelope base image (minus the lid) */
.envelope-img {
  position: relative; /* allow z-index to layer above the letter */
  width: 100%;
  height: auto;
  display: block;
  z-index: 3;
  /* Realistic soft shadow tied to the envelope graphic */
  filter: drop-shadow(-6px 8px 14px rgba(0,0,0,0.40))
          drop-shadow(-2px 3px 6px rgba(0,0,0,0.22));
}

/* Interior texture only behind the letter (no outside bleed) */
.envelope-bg {
  position: absolute;
  top: 0; right: 0; bottom: 0; left: 0;
  z-index: 1; /* behind letter (2) and base (3) */
  background-color: rgba(255,255,255,0.85);
  background-image: url('../assets/paper_texture.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-blend-mode: multiply;
  filter: saturate(0.5) brightness(1.02);
  /* Clip to an inner rectangle so it won't show outside the envelope */
  -webkit-clip-path: inset(var(--bg-inset-top, 26%) var(--bg-inset-right, 6%) var(--bg-inset-bottom, 10%) var(--bg-inset-left, 6%));
  clip-path: inset(var(--bg-inset-top, 24.5%) var(--bg-inset-right, 6%) var(--bg-inset-bottom, 20%) var(--bg-inset-left, 6%));
  transform: translateY(var(--envbg-offset, 8px));
  pointer-events: none;
}

/* Letter containing the hidden image */
.letter {
  position: absolute;
  top: 100px;
  left: 0;
  width: 100%;
  height: 100%;
  background: transparent;
  border-radius: 12px 12px 0 0; /* rounded top corners only */
  z-index: 2; /* behind envelope base by default */
  transition: transform 0.35s ease 0.35s; /* on hover-out, wait for shrink, then move down */
  transform-origin: center bottom;
  /* Fade the letter in slightly after the envelope to avoid initial pop */
  
}

/* inner wrapper to scale later (stage 3) */
.letter-inner {
  width: 100%;
  height: 100%;
  transform: scale(1);
  transform-origin: center bottom;
  transition: transform 0.35s ease 0s; /* shrink immediately on hover-out */
}

.letter img {
  width: 100%;
  height: auto;
  display: block;
}

/* Hover interactions: open lid, then raise letter above it */
.wrapper:hover .lid.one {
  transform: rotateX(90deg);
  transition-delay: 0s;
}

.wrapper:hover .lid.two {
  transform: rotateX(180deg);
  transition-delay: 0.25s;
}

.wrapper:hover .letter {
  /* Stage 2: raise letter only (no scale yet) */
  transform: translateY(-300px);
  transition-delay: 0.15s; /* raise early on hover-in */
  /* Stage 3 begins at 0.35s: bump z-index only then */
  animation: raiseZ 0s 0.35s forwards;
}

@keyframes raiseZ {
  to { z-index: 6; }
}

.wrapper:hover .letter-inner {
  /* Stage 3: scale up letter */
  transform: translateY(300px) scale(1.6);
  position: relative;
  z-index: 6; /* above base and lids */
  will-change: transform;
  transition-delay: 0.35s; /* enlarge after lift on hover-in */
}

/* Hover-out: keep letter above while shrinking, then drop below and slide in */
.wrapper.had-interaction:not(:hover) .letter {
  /* Hold z-index high during shrink, then lower after 0.35s */
  animation: holdZ 0s 0.35s backwards, lowerZ 0s 0.35s forwards;
}

@keyframes holdZ { from { z-index: 6; } to { z-index: 6; } }
@keyframes lowerZ { to { z-index: 2; } }

/* Login form overlay remains unobtrusive */
.login-form-container {
  position: absolute;
  bottom: 10px;
  right: 10px;
  z-index: 10;
}

.login-form {
  background-color: rgba(255, 255, 255, 0.8);
  padding: 10px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  gap: 10px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.12);
}

.login-form label {
  font-size: 0.9em;
  color: #333;
}

.login-form input[type="password"] {
  padding: 6px 8px;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 0.9em;
  width: 120px;
}

.error-message {
  color: #d32f2f;
  font-size: 12px;
  /* Allow \n in strings to render as line breaks */
  white-space: pre-line;
}

/* Responsive tweaks for very narrow screens */
@media (max-width: 480px) {
  /* Center envelope higher on phones and allow scroll below */
  .wrapper {
    position: relative;
    bottom: auto;
    margin: clamp(16px, 10svh, 72px) auto clamp(40px, 14svh, 120px);
    width: min(94vw, 460px);
  }

  /* The letter sits a bit lower by default. Reduce offset on phones */
  .letter {
    top: 20%;
  }

  /* Keep the login visible and reachable above the iOS bottom bar */
  .login-form-container {
    position: fixed;
    right: auto;
    left: 50%;
    transform: translateX(-50%);
    bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
    z-index: 20;
  }

  .login-form {
    gap: 6px;
    padding: 8px;
    background-color: rgba(255, 255, 255, 0.92);
  }
  .login-form input[type="password"] {
    width: 100px;
  }
}
